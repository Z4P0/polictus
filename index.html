<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Polictus</title>
  <meta name="description" content="find out your representative and their financial backers">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
	<link rel="stylesheet" type="text/css" href="style/style.css" />
	<script type="text/javascript" src="scripts/modernizr.js"></script>
	<script type="text/javascript" src="scripts/loader.js"></script></head>
<body id="home">
<a href="#main" class="assistive-text">Skip to main content</a>
<div class="container">
  <header>
    <div class="wrapper">
      <h1>Polictus</h1>
      <p>Find out your elected representative and their financial backers</p>
    </div>
  </header>

  <section id="main" class="content">
    <div class="wrapper">
      <article id="app">
      	<p>Enter your zipcode to find your representatives</p>
      	<input id="zipcode" type="text" placeholder=" ex. 14411" maxlength="5"><br>
      	<input type="button" value="Submit" onclick="validate();">
      </article>
      <!-- empty container -->
      <section id="results"></section>
    </div>
  </section>

  <footer>
    <div class="wrapper">
      <p>Made in Spring 2013. Luis Rosario &amp; Eric Bichan</p>
    </div>
  </footer>
</div>

<script>
document.getElementById('zipcode').addEventListener('keypress', function (e) {if (e.keyCode === 13) validate(); }, false);


	/* check form input */
function validate() {
	// get DOM value
	var input = document.getElementById('zipcode').value;
	
	// make sure it's a string
	if (typeof input === 'string') {
		// test for an empty string
		if (input.length === 0 ) { reportError('Please enter a zipcode to begin. Try 14411'); }
		else {
			// trim empty space off of the beginning and end
			var trimmedInput = trim(input);
			if (trimmedInput.length !== 5) reportError('There is a problem with the input you have entered');
			else {
				var isValid = true;
				// make sure the input is a zipcode
				for (var i = 0; i < trimmedInput.length; i++) {
					// if they can't be parses to ints, it's not valid
					if (!parseInt(trimmedInput[i])) isValid = false;
				};
				
				// now that we tested it..
				if (isValid) console.log('call API');
				else reportError('There is a problem with the zipcode you entered: '+trimmedInput+' is not a valid zipcode.');
			}
		}
	}
	// idk how you would get to the error below but whatevs
	else {reportError('you done goofed');}
}

// prints out error message to user
function reportError(_text) {
	// get DOM reference
	var output = document.getElementById('results');
	// clear the node
	clear(output);
	// appened msg to output
	p = document.createElement('p');
	p.className += 'error';
	p.appendChild(document.createTextNode(_text));
	output.appendChild(p);
	// console.log(_text);
}


/* utils */
/* =================================== */
// trim empty space
function trim(str) {
	// source:
	// http://stackoverflow.com/questions/3000649/trim-spaces-from-start-and-end-of-string
  return str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
}
// clear nodes
function clear(_element) {
  while( _element.hasChildNodes() ) {
    _element.removeChild( _element.firstChild );
  }
}
</script>
</body>
</html>